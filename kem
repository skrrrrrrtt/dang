--=====================================================
-- DRIVING EMPIRE REMOTE + EVENT SCANNER
-- Purpose:
--  ‚Ä¢ Logs ALL RemoteEvent:FireServer calls
--  ‚Ä¢ Logs ALL RemoteFunction:InvokeServer calls
--  ‚Ä¢ Includes Starwatch / Packages / hidden remotes
--  ‚Ä¢ Use this while MANUALLY arresting an Outlaw
--=====================================================

local ReplicatedStorage = game:GetService("ReplicatedStorage")

print("üîç Remote Scanner Loaded")
print("üëâ Manually arrest an OUTLAW and watch console output")

-- Hook function safely
local function hookRemote(remote)
    if remote:IsA("RemoteEvent") then
        local old
        old = hookfunction(remote.FireServer, function(self, ...)
            warn("[RemoteEvent:FireServer]")
            warn("Path:", self:GetFullName())
            warn("Args:", ...)
            return old(self, ...)
        end)

    elseif remote:IsA("RemoteFunction") then
        local old
        old = hookfunction(remote.InvokeServer, function(self, ...)
            warn("[RemoteFunction:InvokeServer]")
            warn("Path:", self:GetFullName())
            warn("Args:", ...)
            return old(self, ...)
        end)
    end
end

-- Scan existing remotes
for _, obj in pairs(ReplicatedStorage:GetDescendants()) do
    pcall(function()
        hookRemote(obj)
    end)
end

-- Scan newly added remotes
ReplicatedStorage.DescendantAdded:Connect(function(obj)
    task.wait(0.1)
    pcall(function()
        hookRemote(obj)
    end)
end)

print("‚úÖ Scanning ALL remotes (including Packages / Starwatch)")
