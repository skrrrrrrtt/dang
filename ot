repeat wait() until game:IsLoaded()
if game.PlaceId == 3351674303 then

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- Settings
_G.ATMSettings = {
    SelectedATM = nil,
    AutoTP = false,
    TPDelay = 5,
    UseVehicle = true,
    ScanDistance = math.huge, -- Unlimited distance
}

-- Get Current Vehicle
function GetCurrentVehicle()
    return LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") 
        and LocalPlayer.Character.Humanoid.SeatPart 
        and LocalPlayer.Character.Humanoid.SeatPart.Parent
end

-- Vehicle TP
function TP(cframe)
    local vehicle = GetCurrentVehicle()
    if vehicle then
        vehicle:SetPrimaryPartCFrame(cframe)
        return true
    end
    return false
end

-- Character TP
function CharacterTP(cframe)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = cframe
        return true
    end
    return false
end

-- Spawn Vehicle
function SpawnVehicle(carName)
    local args = {
        [1] = "Spawn",
        [2] = carName or "Dart"
    }
    ReplicatedStorage.Remotes.VehicleEvent:FireServer(unpack(args))
end

-- Advanced ATM Scanner - Scans ENTIRE map
function ScanForATMs()
    local atms = {}
    local searchTerms = {"atm", "bank", "cash", "money", "withdraw", "deposit"}
    local scanned = {}
    
    print("=== Starting FULL MAP ATM Scan ===")
    print("Scanning entire workspace (unlimited distance)...")
    
    -- Scan ALL descendants in workspace
    local totalScanned = 0
    for _, obj in pairs(Workspace:GetDescendants()) do
        totalScanned = totalScanned + 1
        
        if not scanned[obj] and (obj:IsA("Model") or obj:IsA("Part") or obj:IsA("MeshPart") or obj:IsA("UnionOperation")) then
            scanned[obj] = true
            local name = obj.Name:lower()
            local parent = obj.Parent and obj.Parent.Name:lower() or ""
            local isATM = false
            
            -- Check if name or parent contains ATM keywords
            for _, term in pairs(searchTerms) do
                if name:find(term) or parent:find(term) then
                    isATM = true
                    break
                end
            end
            
            if isATM then
                local position
                local cframe
                local atmObject = obj
                
                -- Get position and CFrame
                if obj:IsA("Model") then
                    local primaryPart = obj.PrimaryPart or obj:FindFirstChildWhichIsA("Part") or obj:FindFirstChildWhichIsA("MeshPart")
                    if primaryPart then
                        position = primaryPart.Position
                        cframe = primaryPart.CFrame * CFrame.new(0, 0, 5) -- 5 studs in front
                        atmObject = primaryPart
                    end
                elseif obj:IsA("BasePart") then
                    position = obj.Position
                    cframe = obj.CFrame * CFrame.new(0, 0, 5)
                end
                
                if position and cframe then
                    -- Calculate distance from player
                    local distance = 0
                    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                        distance = (LocalPlayer.Character.HumanoidRootPart.Position - position).Magnitude
                    end
                    
                    -- Format CFrame string
                    local pos = cframe.Position
                    local rx, ry, rz = cframe:ToOrientation()
                    local cframeString = string.format(
                        "CFrame.new(%.2f, %.2f, %.2f, %.2f, %.2f, %.2f)",
                        pos.X, pos.Y, pos.Z,
                        math.deg(rx), math.deg(ry), math.deg(rz)
                    )
                    
                    table.insert(atms, {
                        name = obj.Name,
                        path = obj:GetFullName(),
                        position = position,
                        cframe = cframe,
                        cframeString = cframeString,
                        distance = distance,
                        object = atmObject
                    })
                    
                    print(string.format("✓ Found: %s | Dist: %.0f studs | Pos: %.1f, %.1f, %.1f", 
                        obj.Name, distance, pos.X, pos.Y, pos.Z))
                end
            end
        end
    end
    
    print(string.format("Scanned %d objects in workspace", totalScanned))
    
    -- Also check specific common locations
    local commonLocations = {
        "Buildings", "Map", "City", "Downtown", "Mall", "Airport", "GasStation", "Bank"
    }
    
    for _, locationName in pairs(commonLocations) do
        local location = Workspace:FindFirstChild(locationName)
        if location then
            print("Checking location: " .. locationName)
            for _, obj in pairs(location:GetDescendants()) do
                if not scanned[obj] and (obj:IsA("Model") or obj:IsA("BasePart")) then
                    scanned[obj] = true
                    local name = obj.Name:lower()
                    
                    for _, term in pairs(searchTerms) do
                        if name:find(term) then
                            local position
                            local cframe
                            
                            if obj:IsA("Model") then
                                local part = obj.PrimaryPart or obj:FindFirstChildWhichIsA("Part")
                                if part then
                                    position = part.Position
                                    cframe = part.CFrame * CFrame.new(0, 0, 5)
                                end
                            elseif obj:IsA("BasePart") then
                                position = obj.Position
                                cframe = obj.CFrame * CFrame.new(0, 0, 5)
                            end
                            
                            if position and cframe then
                                local distance = 0
                                if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                                    distance = (LocalPlayer.Character.HumanoidRootPart.Position - position).Magnitude
                                end
                                
                                local pos = cframe.Position
                                local cframeString = string.format(
                                    "CFrame.new(%.2f, %.2f, %.2f)",
                                    pos.X, pos.Y, pos.Z
                                )
                                
                                table.insert(atms, {
                                    name = obj.Name .. " (" .. locationName .. ")",
                                    path = obj:GetFullName(),
                                    position = position,
                                    cframe = cframe,
                                    cframeString = cframeString,
                                    distance = distance,
                                    object = obj
                                })
                                
                                print(string.format("✓ Found in %s: %s | Dist: %.0f studs", 
                                    locationName, obj.Name, distance))
                            end
                            break
                        end
                    end
                end
            end
        end
    end
    
    -- Add known preset locations as backup
    if #atms < 5 then
        print("Adding preset ATM locations...")
        local presetATMs = {
            {name = "Bank Main ATM", cframe = CFrame.new(-4989.85, 26.7, -2638.16)},
            {name = "Gas Station North ATM", cframe = CFrame.new(-5234.21, 26.7, -1876.43)},
            {name = "Gas Station South ATM", cframe = CFrame.new(-3678.92, 26.7, -3421.87)},
            {name = "Shopping Mall ATM", cframe = CFrame.new(-4521.33, 26.7, -2987.54)},
            {name = "Downtown Center ATM", cframe = CFrame.new(-5678.21, 26.7, -3234.76)},
            {name = "Airport Terminal ATM", cframe = CFrame.new(-3234.56, 26.7, -4123.89)},
            {name = "City Center ATM", cframe = CFrame.new(-5123.45, 26.7, -3012.34)},
            {name = "Highway Rest Stop ATM", cframe = CFrame.new(-4567.89, 26.7, -2345.67)},
        }
        
        for _, preset in pairs(presetATMs) do
            local pos = preset.cframe.Position
            preset.position = pos
            preset.path = "Preset Location"
            preset.cframeString = string.format("CFrame.new(%.2f, %.2f, %.2f)", pos.X, pos.Y, pos.Z)
            
            local distance = 0
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                distance = (LocalPlayer.Character.HumanoidRootPart.Position - pos).Magnitude
            end
            preset.distance = distance
            
            table.insert(atms, preset)
        end
    end
    
    -- Sort by distance
    table.sort(atms, function(a, b)
        return a.distance < b.distance
    end)
    
    print("=== Scan Complete ===")
    print(string.format("Total ATMs Found: %d", #atms))
    print("Sorted by distance from player")
    
    return atms
end

-- Save ATMs to file
function SaveATMsToFile(atms)
    local output = {}
    table.insert(output, "=== ATM Locations for Driving Empire ===")
    table.insert(output, "Scanned on: " .. os.date())
    table.insert(output, "Total ATMs: " .. #atms)
    table.insert(output, "")
    
    for i, atm in ipairs(atms) do
        table.insert(output, string.format("[%d] %s", i, atm.name))
        table.insert(output, string.format("    Distance: %.0f studs", atm.distance))
        table.insert(output, string.format("    Position: %.2f, %.2f, %.2f", 
            atm.position.X, atm.position.Y, atm.position.Z))
        table.insert(output, "    CFrame: " .. atm.cframeString)
        table.insert(output, "    Path: " .. atm.path)
        table.insert(output, "")
    end
    
    local filename = "ATM_Locations_" .. os.time() .. ".txt"
    writefile(filename, table.concat(output, "\n"))
    print("✓ Saved to: " .. filename)
    return filename
end

-- UI Library
do local ui = game:GetService("CoreGui").RobloxGui.Modules:FindFirstChild("UI") if ui then ui:Destroy() end end

local UI = Instance.new("ScreenGui")
UI.Name = "UI"
UI.Parent = game:GetService("CoreGui").RobloxGui.Modules
UI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
if syn then syn.protect_gui(UI) end

local CloseBind = Enum.KeyCode.RightControl

local function MakeDraggable(topbarobject, object)
    local Dragging, DragInput, DragStart, StartPosition

    local function Update(input)
        local Delta = input.Position - DragStart
        local pos = UDim2.new(
            StartPosition.X.Scale,
            StartPosition.X.Offset + Delta.X,
            StartPosition.Y.Scale,
            StartPosition.Y.Offset + Delta.Y
        )
        TweenService:Create(object, TweenInfo.new(0.2), {Position = pos}):Play()
    end

    topbarobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = true
            DragStart = input.Position
            StartPosition = object.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)

    topbarobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            DragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            Update(input)
        end
    end)
end

local ui = {}

function ui:CreateWindow(text, logo1, logo2, toclose)
    CloseBind = toclose or Enum.KeyCode.RightControl
    logo1 = logo1 or 6687442128
    logo2 = logo2 or "6687442128"

    local Main = Instance.new("Frame")
    Main.Name = "Main"
    Main.Parent = UI
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.BackgroundColor3 = Color3.fromRGB(2, 13, 54)
    Main.BorderSizePixel = 0
    Main.ClipsDescendants = true
    Main.Position = UDim2.new(0.5, 0, 0.5, 0)
    Main.Size = UDim2.new(0, 623, 0, 504)

    local Logo = Instance.new("ImageLabel")
    Logo.Name = "Logo"
    Logo.Parent = Main
    Logo.BackgroundTransparency = 1
    Logo.Position = UDim2.new(0.0126051363, 0, 0.013920635, 0)
    Logo.Size = UDim2.new(0, 27, 0, 27)
    Logo.Image = "http://www.roblox.com/asset/?id=" .. tostring(logo1)

    local Name = Instance.new("TextLabel")
    Name.Parent = Main
    Name.BackgroundTransparency = 1
    Name.Position = UDim2.new(0.05, 0, 0, 0)
    Name.Size = UDim2.new(0, 200, 0, 42)
    Name.Font = Enum.Font.GothamSemibold
    Name.Text = text
    Name.TextColor3 = Color3.fromRGB(246, 255, 79)
    Name.TextSize = 14
    Name.TextXAlignment = Enum.TextXAlignment.Left

    local PageTap = Instance.new("Frame")
    PageTap.Name = "PageTap"
    PageTap.Parent = Main
    PageTap.BackgroundColor3 = Color3.fromRGB(4, 20, 82)
    PageTap.Position = UDim2.new(0, 0, 0.297485709, 0)
    PageTap.Size = UDim2.new(0, 155, 0, 354)

    local pagesFolder = Instance.new("Folder")
    pagesFolder.Name = "pagesFolder"
    pagesFolder.Parent = Main

    MakeDraggable(Logo, Main)

    return {Main = Main, pagesFolder = pagesFolder, PageTap = PageTap}
end

-- Create the UI
print("Creating ATM Scanner UI...")

local window = ui:CreateWindow("ATM Scanner | Driving Empire", 6687442128, "6687442128", Enum.KeyCode.RightControl)

-- Scan for ATMs
print("Scanning for ATMs...")
local allATMs = ScanForATMs()

-- Save to file
local filename = SaveATMsToFile(allATMs)

-- Create notification
print(string.format("✓ Found %d ATMs! Saved to %s", #allATMs, filename))

-- Print summary to console
print("\n=== ATM SCAN RESULTS ===")
for i, atm in ipairs(allATMs) do
    print(string.format("[%d] %s - %.0f studs away", i, atm.name, atm.distance))
    print("    " .. atm.cframeString)
end
print("========================\n")

end
