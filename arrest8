--// DRIVING EMPIRE AUTO ARREST (PROXIMITY BASED)
repeat task.wait() until game:IsLoaded()

if game.PlaceId ~= 3351674303 then return end

--// SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

--// STATE
local AutoArrest = false
local CurrentTarget = nil

--// SETTINGS
local Settings = {
    FollowDistance = 3.5,
    UpdateRate = 0.1,
    HoldVelocity = true
}

--// UTILS
local function getHRP(char)
    return char and char:FindFirstChild("HumanoidRootPart")
end

local function isOutlaw(plr)
    return plr.Team and plr.Team.Name:lower():find("outlaw")
end

local function getClosestOutlaw()
    local myHRP = getHRP(LocalPlayer.Character)
    if not myHRP then return nil end

    local closest, dist = nil, math.huge
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and isOutlaw(plr) and plr.Character then
            local hrp = getHRP(plr.Character)
            if hrp then
                local d = (myHRP.Position - hrp.Position).Magnitude
                if d < dist then
                    dist = d
                    closest = plr
                end
            end
        end
    end
    return closest
end

--// FOLLOW + HOLD POSITION
task.spawn(function()
    while task.wait(Settings.UpdateRate) do
        if not AutoArrest then continue end

        local myHRP = getHRP(LocalPlayer.Character)
        if not myHRP then continue end

        if not CurrentTarget or not CurrentTarget.Character or not isOutlaw(CurrentTarget) then
            CurrentTarget = getClosestOutlaw()
        end

        if CurrentTarget then
            local tHRP = getHRP(CurrentTarget.Character)
            if tHRP then
                -- lock position slightly behind outlaw
                myHRP.CFrame =
                    tHRP.CFrame * CFrame.new(0, 0, -Settings.FollowDistance)

                -- stop physics from pushing you away
                if Settings.HoldVelocity then
                    myHRP.AssemblyLinearVelocity = Vector3.zero
                end
            end
        end
    end
end)

--// WINDUI
local WindUI = loadstring(game:HttpGet(
    "https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"
))()

local Window = WindUI:CreateWindow({
    Title = "Auto Arrest",
    SubTitle = "Driving Empire (Real Method)",
    Icon = "shield",
    Size = UDim2.fromOffset(520, 360),
    Theme = "Dark",
    Transparent = true
})

Window:SetToggleKey(Enum.KeyCode.G)

local Main = Window:Tab({
    Title = "Main",
    Icon = "shield"
})

Main:Toggle({
    Title = "ðŸš” Auto Arrest Outlaws",
    Default = false,
    Callback = function(v)
        AutoArrest = v
        if not v then
            CurrentTarget = nil
        end

        WindUI:Notify({
            Title = "Auto Arrest",
            Content = v and "LOCKING ON OUTLAWS" or "DISABLED",
            Duration = 3
        })
    end
})

WindUI:Notify({
    Title = "Loaded",
    Content = "Proximity Auto Arrest Ready",
    Duration = 4
})

print("âœ… AUTO ARREST (PROXIMITY) LOADED")
